# Servicio gRPC de PredicciÃ³n de Vinos

Este servicio implementa un predictor de calidad de vinos usando gRPC y machine learning.

## ğŸ“ Estructura del Proyecto

```
GRP/
â”œâ”€â”€ docker/                  # ConfiguraciÃ³n Docker
â”‚   â”œâ”€â”€ dockerfile          # DefiniciÃ³n de imagen
â”‚   â”œâ”€â”€ requirements.txt    # Dependencias Python
â”‚   â”œâ”€â”€ buildAll.sh        # Script construcciÃ³n
â”‚   â”œâ”€â”€ runAll.sh          # Script ejecuciÃ³n
â”‚   â””â”€â”€ stopAll.sh         # Script detenciÃ³n
â”œâ”€â”€ models/                 # Directorio modelos ML
â”‚   â””â”€â”€ random_forest_model.pkl
â”œâ”€â”€ *.py                    # Archivos Python del servicio
â”œâ”€â”€ *.proto                 # DefiniciÃ³n del servicio gRPC
â”œâ”€â”€ docker-compose.yaml     # ConfiguraciÃ³n Docker Compose
â””â”€â”€ README.md
```

## ğŸš€ Inicio RÃ¡pido

1. PreparaciÃ³n del entorno:
```bash
# Crear directorio para modelos
mkdir -p models

# Dar permisos de ejecuciÃ³n a scripts
chmod +x docker/*.sh

# Copiar tu modelo de ML
cp /ruta/a/tu/modelo/random_forest_model.pkl models/
```

2. Construir y ejecutar:
```bash
# Construir imagen
cd docker && ./buildAll.sh

# Iniciar servicio
docker-compose up -d
```

3. Verificar funcionamiento:
```bash
# Comprobar estado
docker-compose ps

# Ver logs
docker-compose logs -f
```

## ğŸ”§ ConfiguraciÃ³n

### Variables de Entorno
```yaml
GRPC_PORT: 50051          # Puerto gRPC
APP_ENV: production       # Entorno de ejecuciÃ³n
MODEL_PATH: /app/models/random_forest_model.pkl
PYTHONUNBUFFERED: 1      # Logs sin buffer
```

### Puertos
- **50051**: Puerto principal gRPC

### VolÃºmenes
- `./models:/app/models`: Montaje de modelos ML

## ğŸ§ª Pruebas

1. Usando el cliente de prueba:
```bash
python test_client.py
```

2. Usando grpcurl:
```bash
grpcurl -plaintext localhost:50051 wine.WinePredictor/CheckHealth
```

## ğŸ“¦ Docker Compose

```yaml
version: '3.8'
services:
  wine-predictor:
    image: microservicio-grpc:1.0
    ports:
      - "50051:50051"
    volumes:
      - ./models:/app/models
    environment:
      - GRPC_PORT=50051
      - MODEL_PATH=/app/models/random_forest_model.pkl
    networks:
      - microservices-net
```

## ğŸ› ï¸ Scripts Disponibles

### Docker
- `buildAll.sh`: Construye la imagen Docker
- `runAll.sh`: Inicia el servicio
- `stopAll.sh`: Detiene el servicio

### Comandos Docker Compose
```bash
# Iniciar servicio
docker-compose up -d

# Detener servicio
docker-compose down

# Ver logs
docker-compose logs -f
```

## âš ï¸ SoluciÃ³n de Problemas

### Problemas Comunes

1. **Servicio no inicia**
   - Verificar puerto 50051 disponible
   - Comprobar existencia del modelo
   - Revisar logs: `docker-compose logs -f`

2. **Errores de imagen**
   - "Image not found": Ejecutar `buildAll.sh`
   - Verificar nombre correcto de imagen

3. **Problemas de red**
   - Crear red: `docker network create microservices-net`
   - Verificar redes: `docker network ls`

### VerificaciÃ³n de Estado
```bash
# Estado del contenedor
docker-compose ps

# Logs del servicio
docker-compose logs -f wine-predictor

# Health check
grpcurl -plaintext localhost:50051 wine.WinePredictor/CheckHealth
```

## ğŸ“‹ Requisitos

- Docker 20.10+
- Docker Compose 2.0+
- Modelo ML entrenado (random_forest_model.pkl)
- 2GB RAM mÃ­nimo
- Puerto 50051 disponible

## ğŸ”’ Seguridad

- El servicio corre en modo no seguro (gRPC plaintext)
- No exponer directamente a internet
- Considerar implementar TLS para producciÃ³n

## ğŸ“ Notas Adicionales

- Los logs estÃ¡n habilitados por defecto
- El servicio estÃ¡ configurado para producciÃ³n
- El modelo debe estar presente en `models/` antes de iniciar
- La red `microservices-net` se crea automÃ¡ticamente

## ğŸ¤ Contribuciones

Para contribuir:
1. Fork del repositorio
2. Crear rama feature (`git checkout -b feature/AmazingFeature`)
3. Commit cambios (`git commit -m 'Add AmazingFeature'`)
4. Push a la rama (`git push origin feature/AmazingFeature`)
5. Abrir Pull Request```
